def test_match_literals():
    x = 1
    match x:
        case 1:
            result = "one"
        case 2:
            result = "two"
        case _:
            result = "other"
    assert(result == "one", "literal match failed")

def test_match_variable_binding():
    x = 42
    match x:
        case n:
            result = n * 2
    assert(result == 84, "variable binding failed")

def test_match_wildcard():
    x = "anything"
    match x:
        case _:
            result = "matched"
    assert(result == "matched", "wildcard match failed")

def test_match_none():
    x = None
    match x:
        case None:
            result = "is none"
        case _:
            result = "not none"
    assert(result == "is none", "None match failed")

def test_match_bool():
    x = True
    match x:
        case True:
            result = "true"
        case False:
            result = "false"
    assert(result == "true", "bool match failed")

def test_match_string():
    x = "hello"
    match x:
        case "hello":
            result = "matched hello"
        case "world":
            result = "matched world"
        case _:
            result = "no match"
    assert(result == "matched hello", "string match failed")

def test_match_negative():
    x = -5
    match x:
        case -5:
            result = "neg five"
        case 5:
            result = "pos five"
        case _:
            result = "other"
    assert(result == "neg five", "negative match failed")

def test_match_list():
    x = [1, 2, 3]
    match x:
        case [1, 2, 3]:
            result = "exact list"
        case [a, b, c]:
            result = "three elements"
        case _:
            result = "other"
    assert(result == "exact list", "list match failed")

def test_match_list_binding():
    x = [10, 20, 30]
    match x:
        case [a, b, c]:
            result = a + b + c
        case _:
            result = 0
    assert(result == 60, "list binding failed")

def test_match_tuple():
    x = (1, "two")
    match x:
        case (1, "two"):
            result = "matched"
        case _:
            result = "no match"
    assert(result == "matched", "tuple match failed")

def test_match_tuple_binding():
    x = ("name", 42)
    match x:
        case (label, value):
            result = label + ": " + str(value)
        case _:
            result = "no match"
    assert(result == "name: 42", "tuple binding failed")

def test_match_or_pattern():
    x = 2
    match x:
        case 1 | 2 | 3:
            result = "one two or three"
        case _:
            result = "other"
    assert(result == "one two or three", "or pattern failed")

def test_match_guard():
    x = 10
    match x:
        case n if n > 5:
            result = "greater than 5"
        case n:
            result = "5 or less"
    assert(result == "greater than 5", "guard failed")

def test_match_guard_false():
    x = 3
    match x:
        case n if n > 5:
            result = "greater than 5"
        case n:
            result = "5 or less"
    assert(result == "5 or less", "guard false case failed")

def test_match_no_match():
    x = "unmatched"
    result = "default"
    match x:
        case "a":
            result = "a"
        case "b":
            result = "b"
    assert(result == "default", "no match should not change result")

struct Point:
    x: int
    y: int

def test_match_struct_basic():
    p = Point(x=10, y=20)
    match p:
        case Point(x=a, y=b):
            result = a + b
        case _:
            result = 0
    assert(result == 30, "struct pattern basic failed")

def test_match_struct_nested():
    struct Line:
        start: tuple
        end: tuple

    line = Line(start=(0, 0), end=(10, 20))
    match line:
        case Line(start=(x1, y1), end=(x2, y2)):
            result = x2 - x1 + y2 - y1
        case _:
            result = 0
    assert(result == 30, "struct pattern nested failed")

def test_match_struct_empty():
    p = Point(x=5, y=10)
    match p:
        case Point():
            result = "is point"
        case _:
            result = "not point"
    assert(result == "is point", "empty struct pattern failed")

def test_match_struct_literal():
    p = Point(x=0, y=0)
    match p:
        case Point(x=0, y=0):
            result = "origin"
        case Point(x=0):
            result = "on y-axis"
        case Point(y=0):
            result = "on x-axis"
        case _:
            result = "other"
    assert(result == "origin", "struct pattern literal failed")

def test_match_struct_or():
    struct Quit:
        code: int

    struct Exit:
        code: int

    event = Quit(code=0)
    match event:
        case Quit() | Exit():
            result = "should quit"
        case _:
            result = "continue"
    assert(result == "should quit", "struct or pattern failed")

def test_match_struct_guard():
    p = Point(x=5, y=10)
    match p:
        case Point(x=x, y=y) if x > 0 and y > 0:
            result = "first quadrant"
        case _:
            result = "other"
    assert(result == "first quadrant", "struct pattern guard failed")

def test_match_struct_wrong_type():
    struct Circle:
        radius: int

    c = Circle(radius=5)
    match c:
        case Point():
            result = "point"
        case Circle():
            result = "circle"
        case _:
            result = "other"
    assert(result == "circle", "struct wrong type failed")

def test_match_struct_positional():
    p = Point(x=3, y=7)
    match p:
        case Point(a, b):
            result = a * b
        case _:
            result = 0
    assert(result == 21, "struct positional pattern failed")

test_match_literals()
print("test_match_literals passed")

test_match_variable_binding()
print("test_match_variable_binding passed")

test_match_wildcard()
print("test_match_wildcard passed")

test_match_none()
print("test_match_none passed")

test_match_bool()
print("test_match_bool passed")

test_match_string()
print("test_match_string passed")

test_match_negative()
print("test_match_negative passed")

test_match_list()
print("test_match_list passed")

test_match_list_binding()
print("test_match_list_binding passed")

test_match_tuple()
print("test_match_tuple passed")

test_match_tuple_binding()
print("test_match_tuple_binding passed")

test_match_or_pattern()
print("test_match_or_pattern passed")

test_match_guard()
print("test_match_guard passed")

test_match_guard_false()
print("test_match_guard_false passed")

test_match_no_match()
print("test_match_no_match passed")

test_match_struct_basic()
print("test_match_struct_basic passed")

test_match_struct_nested()
print("test_match_struct_nested passed")

test_match_struct_empty()
print("test_match_struct_empty passed")

test_match_struct_literal()
print("test_match_struct_literal passed")

test_match_struct_or()
print("test_match_struct_or passed")

test_match_struct_guard()
print("test_match_struct_guard passed")

test_match_struct_wrong_type()
print("test_match_struct_wrong_type passed")

test_match_struct_positional()
print("test_match_struct_positional passed")

print("\nAll match tests passed!")
