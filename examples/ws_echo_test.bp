def handle_client(ws):
    print("Server: Client connected")
    msg = ws.recv()
    if msg:
        print("Server: Received:", msg)
        ws.send("Echo: " + msg)
    print("Server: Done")

server = ws_server(8766, handle_client)
print("Server started on port", server["port"])

sleep(0.5)

print("Connecting client...")
client = ws_connect("ws://localhost:8766/")
print("Client: Connected")

client.send("Hello from client!")
print("Client: Sent message")

response = client.recv()
print("Client: Received:", response)

client.close()
print("Client: Closed")

stop(server)
print("Server stopped")
print("Test passed!")
